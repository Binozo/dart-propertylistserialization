import 'package:propertylistserialization/propertylistserialization.dart';
import 'package:test/test.dart';

import 'binarypropertylistreader_test.dart';

void main() {
  test('iOSAppBinaryPlist', () {
    var template = '62706c6973743030df10170102030405060708090a0b0c0d0e0f1011121'
        '31415161718191a1b1c1d1e2d2e2f3031323439411d43445a5b5c5d5c434642756e646'
        'c654e616d655f101655494c61756e636853746f7279626f6172644e616d655f1019434'
        '642756e646c65446576656c6f706d656e74526567696f6e5f100f434642756e646c655'
        '6657273696f6e5f101055495374617475734261725374796c655f10115549537461747'
        '57342617248696464656e5f1015434642756e646c65446f63756d656e7454797065735'
        'f1013434642756e646c655061636b616765547970655f10184e5346616365494455736'
        '167654465736372697074696f6e5f101a434642756e646c6553686f727456657273696'
        'f6e537472696e675f101d434642756e646c65496e666f44696374696f6e61727956657'
        '273696f6e5f1012434642756e646c6545786563757461626c655f101c5549526571756'
        '97265644465766963654361706162696c69746965735f10255549537570706f7274656'
        '4496e746572666163654f7269656e746174696f6e737e697061645f1010434642756e6'
        '46c6555524c54797065735f1012434642756e646c654964656e7469666965725f10285'
        '54956696577436f6e74726f6c6c6572426173656453746174757342617241707065617'
        '2616e63655f1011434642756e646c655369676e61747572655f101a55544578706f727'
        '46564547970654465636c61726174696f6e735d434642756e646c6549636f6e735f101'
        '24c5352657175697265734950686f6e654f535f1013434642756e646c65446973706c6'
        '1794e616d655f10205549537570706f72746564496e746572666163654f7269656e746'
        '174696f6e735f100f247b50524f445543545f4e414d457d5c4c61756e6368536372656'
        '56e52656e5a312e302e312e313030305f102055495374617475734261725374796c654'
        '26c61636b5472616e736c7563656e7408a11fd520212223242526292b2c5f101043464'
        '2756e646c65547970654e616d655f1015434642756e646c655479706549636f6e46696'
        'c65735f10124c534974656d436f6e74656e7454797065735f1010434642756e646c655'
        '4797065526f6c655d4c5348616e646c657252616e6b5f100f417070666967757261746'
        '520617070a227285f1010446f63756d656e7449636f6e2e706e675f1013446f63756d6'
        '56e7449636f6e3332302e706e67a12a5f10226e7a2e636f2e656c656374726963626f6'
        'c742e61707066696775726174652e61706356456469746f72554f776e6572544150504'
        'c5f101b557365204661636520494420746f2061757468656e74696361746555312e302'
        'e3153362e305f1012247b45584543555441424c455f4e414d457da1335561726d7637a'
        '4353637385f101e5549496e746572666163654f7269656e746174696f6e506f7274726'
        '169745f10285549496e746572666163654f7269656e746174696f6e506f72747261697'
        '4557073696465446f776e5f10235549496e746572666163654f7269656e746174696f6'
        'e4c616e6473636170654c6566745f10245549496e746572666163654f7269656e74617'
        '4696f6e4c616e6473636170655269676874a13ad23b3c3d3e5f100f434642756e646c6'
        '555524c4e616d655f1012434642756e646c6555524c536368656d65735f101e6e7a2e6'
        '36f2e656c656374726963626f6c742e6170706669677572617465a23f405b617070666'
        '96775726174655c6170706669677572617465315f101c242850524f445543545f42554'
        'e444c455f4944454e5449464945522908543f3f3f3fa145d7464748494a4b4c4d4e505'
        '35455565f101555545479706553697a6533323049636f6e46696c655f1010555454797'
        '065436f6e666f726d73546f5f100f55545479706549636f6e46696c65735f101055545'
        '47970654964656e7469666965725f10115554547970654465736372697074696f6e5f1'
        '01455545479706553697a65363449636f6e46696c655f1016555454797065546167537'
        '06563696669636174696f6e5f100f446f63756d656e7449636f6e333230a14f5b70756'
        '26c69632e64617461a251525c446f63756d656e7449636f6e5f100f446f63756d656e7'
        '449636f6e3332305f10226e7a2e636f2e656c656374726963626f6c742e61707066696'
        '775726174652e6170635f100f4170706669677572617465206170705c446f63756d656'
        'e7449636f6ed157585f10197075626c69632e66696c656e616d652d657874656e73696'
        'f6ea15953617063d0095f100f247b50524f445543545f4e414d457da45e5f60615f101'
        'e5549496e746572666163654f7269656e746174696f6e506f7274726169745f1023554'
        '9496e746572666163654f7269656e746174696f6e4c616e6473636170654c6566745f1'
        '0245549496e746572666163654f7269656e746174696f6e4c616e64736361706552696'
        '768745f10285549496e746572666163654f7269656e746174696f6e506f72747261697'
        '4557073696465446f776e000800390046005f007b008d00a000b400cc00e200fd011a0'
        '13a014f016e019601a901be01e901fd021a0228023d0253027602880295029802a302c'
        '602c702c902d402e702ff0314032703350347034a035d03730375039a03a103a703ac0'
        '3ca03d003d403e903eb03f103f6041704420468048f0491049604a804bd04de04e104e'
        'd04fa0519051a051f052105300548055b056d0580059405ab05c405d605d805e405e70'
        '5f40606062b063d064a064d0669066b066f067006710683068806a906cf06f60000000'
        '000000201000000000000006200000000000000000000000000000721';

    var rootDict = PropertyListSerialization
        .propertyListWithData(
        bytes(template), Format.binary) as Map<String,Object>;
    expect(rootDict['CFBundleDevelopmentRegion'], 'en');

    var docTypes = rootDict['CFBundleDocumentTypes'] as List;
    var docTypesDict = docTypes[0] as Map<String, Object>;
    var iconFiles = docTypesDict['CFBundleTypeIconFiles'] as List;
    expect(iconFiles[1], 'DocumentIcon320.png');

    expect(rootDict['UIStatusBarHidden'], false);

    var exportedTypeDecls = rootDict['UTExportedTypeDeclarations'] as List;
    var exportedTypeDeclsDict = exportedTypeDecls[0] as Map<String, Object>;
    var specsDict = exportedTypeDeclsDict['UTTypeTagSpecification'] as
      Map<String, Object>;
    var extensions = specsDict['public.filename-extension'] as List;
    expect(extensions[0], 'apc');
  });
}